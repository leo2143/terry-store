CREATE TABLE rarities (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE categories (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE equipments (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    type ENUM('sword', 'shield') NOT NULL,
    category_id INT UNSIGNED,
    rarity_id INT UNSIGNED,
    material VARCHAR(255),
    ability VARCHAR(255),
    description TEXT,
    price DECIMAL(10,2),
    date_added DATE,
    image VARCHAR(255),
    FOREIGN KEY (category_id) REFERENCES categories(id),
    FOREIGN KEY (rarity_id) REFERENCES rarities(id)
);



CREATE TABLE comments (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    equipment_id INT UNSIGNED NOT NULL,
    username VARCHAR(100),
    content TEXT NOT NULL,
    rating TINYINT UNSIGNED CHECK (rating BETWEEN 1 AND 5),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (equipment_id) REFERENCES equipments(id) ON DELETE CASCADE
);

CREATE TABLE features (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE
);


CREATE TABLE equipment_features (
    equipment_id INT UNSIGNED,
    feature_id INT UNSIGNED,
    PRIMARY KEY (equipment_id, feature_id),
    FOREIGN KEY (equipment_id) REFERENCES equipments(id) ON DELETE CASCADE,
    FOREIGN KEY (feature_id) REFERENCES features(id) ON DELETE CASCADE
);

CREATE TABLE views (
    id INT UNSIGNED AUTO_INCREMENT  PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    title VARCHAR(150) NOT NULL,
    active BOOLEAN NOT NULL DEFAULT TRUE,
    restricted BOOLEAN NOT NULL DEFAULT FALSE
);

CREATE TABLE users (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY ,
    email VARCHAR(255) NOT NULL UNIQUE,
    username VARCHAR(100) NOT NULL UNIQUE,
    full_name VARCHAR(150) NOT NULL,
    password VARCHAR(255) NOT NULL,
    role ENUM('client', 'admin', 'superAdmin') NOT NULL DEFAULT 'client'
);





INSERT INTO categories (name) VALUES
  ('Escudo ligero'),
  ('Escudo mediano'),
  ('Escudo pesado'),
  ('Escudo improvisado'),
  ('Escudo ofensivo'),
  ('Espada pesada'),
  ('Espada larga'),
  ('Lanza legendaria'),
  ('Espada de una mano'),
  ('Espada maldita'),
  ('Espada curva'),
  ('Martillo gigante');

INSERT INTO rarities (name) VALUES
  ('Común'),
  ('Poco común'),
  ('Rara'),
  ('Épica'),
  ('Legendaria'),
  ('Muy común');

INSERT INTO equipments (id, name, type, category_id, rarity_id, material, ability, description, price, date_added, image) VALUES
  (1, 'Escudo de madera', 'Shield', 1, 1, 'Madera hyliana tratada', 'Ideal para principiantes', 'Fácil de conseguir, fácil de romper. Pero Terry insiste en que este tiene “historia”. ¿Será por las manchas de sopa?', 80.00, '2025-04-08', 'traveler_shield.png'),
  (2, 'Escudo de soldado', 'Shield', 2, 3, 'Aleación de hierro y cuero', 'Alta durabilidad, resistente al fuego', 'Usado por soldados de Hyrule en tiempos de paz y guerra. Terry dice que lo ganó en una carrera de gallinas.', 240.00, '2024-04-08', 'soldier_shield.png'),
  (3, 'Escudo de caballero', 'Shield', 3, 4, 'Acero hyliano pulido', 'Parada perfecta causa retroceso', 'Diseñado para caballeros de élite. Terry afirma que este modelo puede “desviar flechas”. No lo hemos probado... aún.', 380.00, '2025-05-08', 'knight-shield.png'),
  (4, 'Escudo real', 'Shield', 3, 5, 'Oro forjado con alma de guardián', 'Resiste todo tipo de daño', 'Un escudo digno de la realeza. Pocos lo han empuñado... y ahora Terry lo tiene en su carrito. Increíble, ¿verdad?', 500.00, '2024-02-08', 'royal-shield.png'),
  (5, 'Escudo Boko', 'Shield', 4, 6, 'Madera y huesos', 'Ligero pero frágil', 'Hecho por bokoblins con amor (o furia). Ideal para un combate rápido o como bandeja de picnic, según Terry.', 50.00, '2024-12-08', 'boko-shield.png'),
  (6, 'Escudo Boko con pinchos', 'Shield', 5, 2, 'Madera y clavos oxidados', 'Daño al embestir', 'Una mezcla entre escudo y trampa bokoblin casera. Terry lo recomienda para “disuasión persuasiva”.', 120.00, '2024-07-08', 'spiked-boko-shield.png'),
  (7, 'Escudo Lizal reforzado', 'Shield', 2, 3, 'Caparazón endurecido con huesos', 'Gran defensa contra ataques físicos', 'Los lizalfos no bromean con la defensa. Este escudo es grueso, feo... y tremendamente efectivo. Palabras de Terry.', 260.00, '2025-09-07', 'reinforced-lizal-shield.png'),
  (8, 'Mandoble real', 'Sword', 6, 5, 'Acero real de Hyrule', 'Gran daño en área', 'Un mandoble reservado para campeones reales. Según Terry, se usó para cortar una montaña en dos. Nadie lo ha confirmado, pero lo dice muy convencido.', 700.00, '2024-02-08', 'royal_claymore.png'),
  (9, 'Espada larga de plata', 'Sword', 7, 3, 'Acero plateado zora', 'Mayor alcance de ataque', 'Elegante y efectiva. Dicen que los zora la usaban para defender sus dominios. Terry dice que la encontró en una terma en descuento.', 400.00, '2024-05-06', 'eightfold_longblade.png'),
  (10, 'Tridente de escamas de luz', 'Sword', 8, 4, 'Escamas zora y cristal', 'Ataques rápidos bajo el agua', 'Forjado especialmente para la campeona Mipha. Terry asegura que llegó por “medios misteriosos”.', 620.00, '2025-01-01', 'lightscale_trident.png'),
  (11, 'Espada ancha de caballero', 'Sword', 9, 4, 'Acero hyliano reforzado', 'Versátil y equilibrada', 'Perfecta para los caballeros de élite. Su diseño equilibrado la hace ideal para combate cuerpo a cuerpo. Terry dice que combina con todo.', 340.00, '2025-01-07', 'knight_broadsword.png'),
  (12, 'Mandoble de caballero', 'Sword', 6, 4, 'Acero hyliano endurecido', 'Ataques devastadores en área', 'Una versión más pesada del arma de los caballeros. Terry la promociona como “para romper cosas... o convencer enemigos”.', 420.00, '2025-03-04', 'knight_claymore.png'),
  (13, 'Espada del resplandor', 'Sword', 10, 5, 'Metal corrompido por Ganon', 'Daña al enemigo... y al portador', 'Una espada envuelta en oscuridad. Tremendamente poderosa, pero peligrosa. Terry la guarda con guantes. Tú también deberías.', 880.00, '2025-07-02', 'gloom-sword.png'),
  (14, 'Cimitarra Gerudo', 'Sword', 11, 3, 'Acero del desierto', 'Ataques rápidos con estilo', 'Usada por guerreras gerudo. Ágil, ligera y con filo impecable. Terry afirma que aprendió a bailar con una de estas. Nadie le cree.', 380.00, '2024-09-08', 'gerudo_scimitar.png'),
  (15, 'Rompe rocas', 'Sword', 12, 4, 'Minerales de Eldin', 'Aumenta daño a enemigos blindados', 'Un arma colosal capaz de destruir minerales con facilidad. Terry dice que una vez cocinó sobre el metal tras una batalla. Aún huele a carne asada.', 510.00, '2025-05-03', 'boulder_breaker.png');


INSERT INTO features (name) VALUES
  ('Ideal para principiantes'),
  ('Alta durabilidad, resistente al fuego'),
  ('Parada perfecta causa retroceso'),
  ('Resiste todo tipo de daño'),
  ('Ligero pero frágil'),
  ('Daño al embestir'),
  ('Gran defensa contra ataques físicos'),
  ('Gran daño en área'),
  ('Mayor alcance de ataque'),
  ('Ataques rápidos bajo el agua'),
  ('Versátil y equilibrada'),
  ('Ataques devastadores en área'),
  ('Daña al enemigo... y al portador'),
  ('Ataques rápidos con estilo'),
  ('Aumenta daño a enemigos blindados');

INSERT INTO equipment_features (equipment_id, feature_id) VALUES
  (1, 1),   -- Escudo de madera → Ideal para principiantes
  (2, 2),   -- Escudo de soldado → Alta durabilidad, resistente al fuego
  (3, 3),   -- Escudo de caballero → Parada perfecta causa retroceso
  (4, 4),   -- Escudo real → Resiste todo tipo de daño
  (5, 5),   -- Escudo Boko → Ligero pero frágil
  (6, 6),   -- Escudo Boko con pinchos → Daño al embestir
  (7, 7),   -- Escudo Lizal reforzado → Gran defensa contra ataques físicos

  (8, 8),   -- Mandoble real → Gran daño en área
  (9, 9),   -- Espada larga de plata → Mayor alcance de ataque
  (10, 10), -- Tridente escamas de luz → Ataques rápidos bajo el agua
  (11, 11), -- Espada ancha de caballero → Versátil y equilibrada
  (12, 12), -- Mandoble de caballero → Ataques devastadores en área
  (13, 13), -- Espada del resplandor → Daña al enemigo... y al portador
  (14, 14), -- Cimitarra Gerudo → Ataques rápidos con estilo
  (15, 15); -- Rompe rocas → Aumenta daño a enemigos blindados

Insert into views(name,title,active,restricted) Values
	('about-terry','Sobre Terry',1,0),
	('opinions','Sobre Terry',1,0),
	('equipments','Sobre Terry',1,0),
	('Arma','Sobre Terry',1,0),
	('Escudo','Sobre Terry',1,0),
	('alumno','Sobre Terry',1,0);